# 从paxos到Zookeeper 
score:50  now: 28
# 第一章 分布式架构  5
 - 去IOE运动  从大型主机到分布式
 - 集中式主机，卓越大型主机
 - 分布式特点: 空间随机分布，对等性，无主从。并发性，涉及对资源并发访问。缺乏全局时钟，微妙级差距可能很大。故障总是会发生。
 - 分布式问题：通信较慢或者异常，如内存访问比网络通信快近100倍。脑裂。三态，成功，失败，超时。
 - ACID：原子性,一致性，隔离性，持久性。
 - CAP：一致性,数据一致。可用性，有限时间返回可用的结果。分区容错性。一般在一致性和分区可用性平衡。
 - BASE: 基本可用，允许时间和功能上的损失。弱状态，允许不同节点数据同步存在延迟。最终一致性，数据最终达到一致。
 - 一致性：因果一致性，读己所写，会话一致性，单调读一致性，单调写一致性。如mysqlInorDB内核设计。 

# 第二章 一致性协议  5
 - 2PC 存在同步阻塞，二阶段提交时，所有操作阻塞。协调者单点问题，二阶段出问题，参与者事务资源锁定。数据不一致，二阶段提交时崩溃。太过保守，没有良好的容错机制，一个失败，全部回滚。
 	阶段一:协调者事务询问。 参与者执行事务 。协调者反馈给执行者 。
 	阶段二:协调者发送请求。参与者执行事务。反馈执行者。协调者接收到所有消息，完成事务。
 	中断：协调者发送中断请求。参与者回滚。反馈执行者。协调者接收到所有消息，完成回滚。
 - 3PC 同步阻塞范围变小。三阶段仍然可能不一致。
    阶段一：事务询问。反馈。
    阶段二：参与者发送预提交。参与者事务预提交。反馈协调者。
    中断：协调者发送中断，参与者中断事务。或者超时中断。
    阶段三:协调者发送提交请求。事务提交。反馈提交结果。完成事务。
    中断：发送中断。事务回滚。反馈回滚。中断事务。
 - paxos 协议
     三个角色: Proposer,Accepter,Learner。
     提案选定一阶段:P预提案，P,A保留最大的V。
     提案选定二阶段:P提案，A回应 
     提案获取:L获取A [无主从，主从，主集合从]

# 第三章 paxos的工程实践  5
 - Chubby 分布式锁服务
 	通过租期保持强一致性
 	与zookper不同，Chubby对应用程序的入侵更小
 	paxos用于日志的一致性，提供可容错数据库，类似mysql实现，快照减少日志。
 - HyperTable 高并发数据库

# 第四章 Zookeeper 与 Paxos 5  
 - zookeeper是一个分布式协调服务
 - 顺序一致性，原子性，单一视图，可靠性，实时性。
 - 设计目标:使分布式程序能够通过共享的树来互相协调。可以构建集群。顺序访问。高性能。
 - 角色(Observer,Follower,Leader)。会话(Tcp,2182)。数据节点（持久，临时，sequenctial,可存储数据）。Wacther(事件监听器)。版本（当前版本，子版本，acl）
 - ZAB协议是一个为zookeeper专门设计的崩溃可恢复的一个原子广播协议，
 - leader（全局唯一的服务器来协调，可理解为简化版paxos，只有一个leader。 
 - 两种模式：崩溃恢复 ，消息广播。（过半支持）
 - 消息广播：类似二阶段，但无中断。过半反馈就提交。
 - leader选举算法:编号最大(前32位leader周期，后32位事务ID)，确保已提交崩溃事务c，丢弃抛弃事务p。
 - 发现阶段：f将p发给L。L统计最大并转发。获得一半成为L.找出一个进度仅次与L的F
 - 同步:与F同步，然后再找F‘进行同步。
 - 广播：leader负责客户请求转换提议，并转发给fllower ，过半反馈给flower，flower提交
  
# 第五章 使用Zookeeper 10
 - creat ls get set delete 一些简单的函数调用 
 - zookeepr 操作繁琐
 - ckclint 比原生的操作简单一点
 - curator 流式操作

# 第六章 Zookeeper的典型应用  15
 - 数据发布订阅 客户端监听一个节点的变化
 - 负载均衡
 - 命名服务
 - 分布式协调/通知
 - 集群管理
 - 分布式锁
 - 分布式队列
# 第七章 Zookeeper技术内幕  5 